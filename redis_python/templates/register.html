<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>

    <div class="form-container">
        <h3 class="mb-4 text-center">üìù Register</h3>
        {% if request.query_params.get("error") %}
            <div class="alert alert-danger" role="alert">
                Username already exists. Please choose another.
            </div>
        {% endif %}
        <form method="post" action="/register" onsubmit="return validatePassword()">
            <div class="mb-3">
                <label for="username" class="form-label">Username</label>
                <input type="text" name="username" id="username" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="password" class="form-label">Password</label>
                <input type="password" name="password" id="password" class="form-control" required oninput="checkStrength()">
                <div id="passwordFeedback" class="feedback text-muted mt-1"></div>
            </div>
            <button type="submit" class="btn btn-primary w-100">Create Account</button>
        </form>
        <div class="mt-3 text-center">
            <a href="/login">Already have an account? Login</a>
        </div>
    </div>

    <script>
        function checkStrength() {
            const pwd = document.getElementById("password").value;
            const feedback = document.getElementById("passwordFeedback");

            const lengthOK = pwd.length >= 8;
            const upperOK = /[A-Z]/.test(pwd);
            const lowerOK = /[a-z]/.test(pwd);
            const digitOK = /\d/.test(pwd);
            const symbolOK = /[^A-Za-z0-9]/.test(pwd);

            if (!pwd) {
                feedback.textContent = "";
                return;
            }

            if (lengthOK && upperOK && lowerOK && digitOK && symbolOK) {
                feedback.textContent = "‚úÖ Strong password";
                feedback.classList.remove("text-danger");
                feedback.classList.add("text-success");
            } else {
                feedback.textContent = "‚ö†Ô∏è Password must be at least 8 characters and include uppercase, lowercase, number, and symbol.";
                feedback.classList.remove("text-success");
                feedback.classList.add("text-danger");
            }
        }

        function validatePassword() {
            const pwd = document.getElementById("password").value;
            const lengthOK = pwd.length >= 8;
            const upperOK = /[A-Z]/.test(pwd);
            const lowerOK = /[a-z]/.test(pwd);
            const digitOK = /\d/.test(pwd);
            const symbolOK = /[^A-Za-z0-9]/.test(pwd);

            if (lengthOK && upperOK && lowerOK && digitOK && symbolOK) {
                return true;
            }

            alert("Please enter a stronger password.");
            return false;
        }
    </script>

    <script>
  function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
    localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
  }

  // Load preference on page load
  window.onload = function () {
    if (localStorage.getItem('darkMode') === 'true') {
      document.body.classList.add('dark-mode');
    }
  };
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  {% include 'footer.html' %}

</body>
</html>
